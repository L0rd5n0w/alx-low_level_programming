Even more malloc that i do not understand
